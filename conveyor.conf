// Before packaging do the build like this:
//
// mvn install -pl styles
// mvn install -pl base
// mvn prepare-package jar:jar -pl sampler

// Use Amazon's Java 17 build, latest as of packaging. OpenJDK already moved on to 18.
include required("/stdlib/jdk/17/amazon.conf")
// Import JavaFX JMODs.
include required("/stdlib/jvm/javafx/from-jmods.conf")
// Small tweaks e.g. enabling proxy detection (https://conveyor.hydraulic.dev/2/stdlib/jvm-clients/)
include required("/stdlib/jvm/enhancements/client/v1.conf")

javafx.version = 17.0.1

app {
  display-name = AtlantaFX Sampler
  fsname = atlantafx-sampler

  // Not allowed to have versions ending in -SNAPSHOT
  version = 1.1.0

  // Open source projects use Conveyor for free.
  vcs-url = github.com/mkpaz/atlantafx

  // Import the JARs.
  inputs += sampler/target/dependencies

  // Linux/macOS want rounded icons, Windows wants square.
  icons = "sampler/icons/icon-rounded-*.png"
  windows.icons = "sampler/icons/icon-square-*.png"

  jvm {
    gui.main-class = atlantafx.sampler.Launcher
    modules = [ java.logging, jdk.localedata, java.desktop, java.prefs, javafx.controls, javafx.swing, javafx.web ]
  }

  // Check for updates on every start and pop up a dialog if found, as this app will only be run occasionally (e.g. on new releases).
  // NB: Update checks won't occur if the most recent update was done within <= 1 hour. This is Mac specific because on Windows update
  // checks are done whether or not the app is running, and on Linux updates are handled by the package manager.
  mac.updates = aggressive

  site.base-url = downloads.hydraulic.dev/atlantafx/sampler
}

conveyor.compatibility-level = 4
